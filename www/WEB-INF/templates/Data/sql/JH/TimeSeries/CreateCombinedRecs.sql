-- jh_global_timeseries  CREATE combined recordsDELETE FROM combined WHERE sourcecode = 'JH_GLOBAL_CONF';INSERT INTO combined(sourcecode,state,country,datechecked,date,confirmed)SELECT DISTINCT'JH_GLOBAL_CONF' as sourcecode,state,country,date as datechecked,to_date(date,'mm/dd/yy') as date,CASE 	WHEN ct = 0 THEN null	ELSE ctEND as confirmedFROM jh_timeseriesWHERE 1 = 1AND type = 'C';/*UPDATE combinedSET confirmed = v1.ctFROM( SELECT * FROM jh_timeseriesWHERE type = 'C') AS v1WHERE (combined.state = v1.state OR (combined.state is null AND v1.state is null))AND combined.country = v1.countryAND combined.datechecked = v1.date;*/UPDATE combinedSET death = v1.ctNonZeroFROM( SELECT *,	CASE 		WHEN ct = 0 THEN null		ELSE ct	END as ctNonZero	FROM jh_timeseries	WHERE type = 'D') AS v1WHERE (combined.state = v1.state OR (combined.state is null AND v1.state is null))AND combined.country = v1.countryAND combined.datechecked = v1.date;UPDATE combinedSET recovered = v1.ctNonZeroFROM( SELECT * 	CASE		WHEN ct = 0 THEN null		ELSE ct	END as ctNonZero	FROM jh_timeseries	WHERE type = 'R') AS v1WHERE (combined.state = v1.state OR (combined.state is null AND v1.state is null))AND combined.country = v1.countryAND combined.datechecked = v1.date;