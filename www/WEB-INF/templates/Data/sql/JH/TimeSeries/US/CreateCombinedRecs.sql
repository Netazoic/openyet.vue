INSERT INTO combined(  sourcecode,  county,  state,  statecode,  country,  datechecked,  date)SELECT DISTINCT'JH_US' as sourcecode,county,state.name,ansi as statecode,country,date as datechecked,to_date(date,'mm/dd/yy') as dateFROM jh_us_timeseries tsJOIN state on (ts.state = state.name);-- Confirmed updates-- National rollupsUPDATE combinedSET confirmed = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'C') AS v1WHERE (combined.state=null and v1.state=null)AND combined.country = v1.countryAND combined.datechecked = v1.date;-- State rollupsUPDATE combinedSET confirmed = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'C') AS v1WHERE (combined.county=null and v1.county=null)AND combined.state = v1.stateAND combined.country = v1.countryAND combined.datechecked = v1.date;-- county RecordsUPDATE combinedSET confirmed = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'C') AS v1WHERE (combined.state = v1.state)AND combined.country = v1.countryAND combined.county = v1.countyAND combined.datechecked = v1.date;-- Death ct updates-- National rollupsUPDATE combinedSET death = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'D') AS v1WHERE (combined.state=null and v1.state=null)AND combined.country = v1.countryAND combined.datechecked = v1.date;-- State rollupsUPDATE combinedSET death = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'D') AS v1WHERE (combined.county=null and v1.county=null)AND combined.state = v1.stateAND combined.country = v1.countryAND combined.datechecked = v1.date;-- county RecordsUPDATE combinedSET death = v1.ctFROM( SELECT * FROM jh_us_timeseriesWHERE type = 'D') AS v1WHERE (combined.state = v1.state)AND combined.country = v1.countryAND combined.county = v1.countyAND combined.datechecked = v1.date;