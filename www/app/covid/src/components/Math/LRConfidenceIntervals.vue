<template>
<div id="gbox" style="border: 1px solid black; position: absolute;
      top: 10px; left: 10px; width: 502px; height: 302px;
      background-color: rgb(255, 255, 187);"> </div>
    <form method="get" name="f">
      <table cool="" gridx="16" gridy="10" showgridx="" showgridy="" usegridx="" usegridy="" border="0" cellpadding="0" cellspacing="0" height="433" width="709">
        <tbody>
          <tr height="30">
            <td rowspan="17" height="432" width="16"><br>
            </td>
            <td colspan="5" rowspan="11" height="320" width="496"><br>
            </td>
            <td colspan="2" height="30" width="48"><br>
            </td>
            <td xpos="560" align="left" height="30" valign="top" width="64"><label><font color="blue">X</font></label></td>
            <td height="30" width="16"><br>
            </td>
            <td xpos="640" align="left" height="30" valign="top" width="68"><label><font color="blue">Y</font></label></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>1</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x1" value="0" size="10" tabindex="1" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y1" value="100.1" size="10" tabindex="2" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>2</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x2" value="6" size="10" tabindex="3" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y2" value="98.1" size="10" tabindex="4" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>3</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x3" value="12" size="10" tabindex="5" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y3" value="95.9" size="10" tabindex="6" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>4</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x4" size="10" tabindex="7" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y4" size="10" tabindex="8" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>5</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x5" size="10" tabindex="9" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y5" size="10" tabindex="10" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>6</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x6" size="10" tabindex="11" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y6" size="10" tabindex="12" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>7</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x7" size="10" tabindex="13" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y7" size="10" tabindex="14" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>8</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x8" size="10" tabindex="15" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y8" size="10" tabindex="16" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="512" align="left" height="30" valign="top" width="32"><label>9</label></td>
            <td colspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x9" size="10" tabindex="17" border="0" type="text"></td>
            <td colspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y9" size="10" tabindex="18" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="20">
            <td rowspan="2" xpos="512" align="left" height="30" valign="top" width="32"><label>10</label></td>
            <td colspan="2" rowspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x10" size="10" tabindex="19" border="0" type="text"></td>
            <td colspan="2" rowspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y10" size="10" tabindex="20" border="0" type="text"></td>
            <td height="20" width="1"><spacer type="block" height="20" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="10">
            <td rowspan="2" xpos="16" align="left" height="30" valign="top" width="64"><label><font color="red">Slope</font></label></td>
            <td rowspan="2" xpos="80" align="left" height="30" valign="top" width="128"><input name="slope" readonly="readonly" size="16" border="0" type="text"></td>
            <td rowspan="2" xpos="208" align="left" height="30" valign="top" width="80"><input name="plotbutton" value="
                Replot! " onclick="replot()" border="0" type="button"></td>
            <td rowspan="2" xpos="288" align="left" height="30" valign="top" width="80"><label><font color="blue"> X</font>
              </label></td>
            <td rowspan="2" xpos="368" align="left" height="30" valign="top" width="144"><input name="xpred" value="24" size="16" tabindex="25" border="0" type="text"></td>
            <td height="10" width="1"><spacer type="block" height="10" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="20">
            <td rowspan="2" xpos="512" align="left" height="30" valign="top" width="32"><label>11</label></td>
            <td colspan="2" rowspan="2" xpos="544" align="left" height="30" valign="top" width="80"><input name="x11" size="10" tabindex="21" border="0" type="text"></td>
            <td colspan="2" rowspan="2" xpos="624" align="left" height="30" valign="top" width="84"><input name="y11" size="10" tabindex="22" border="0" type="text"></td>
            <td height="20" width="1"><spacer type="block" height="20" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="10">
            <td rowspan="2" xpos="16" align="left" height="30" valign="top" width="64"><label><font color="red">Intercept</font></label></td>
            <td rowspan="2" xpos="80" align="left" height="30" valign="top" width="128"><input name="intercept" readonly="readonly" size="16" border="0" type="text"></td>
            <td rowspan="4" height="82" width="80"><br>
            </td>
            <td rowspan="2" xpos="288" align="left" height="30" valign="top" width="80"><label> <font color="green">Y
                  upper</font> </label></td>
            <td rowspan="2" xpos="368" align="left" height="30" valign="top" width="144"><input name="yupper" readonly="readonly" size="16" border="0" type="text"></td>
            <td height="10" width="1"><spacer type="block" height="10" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="20">
            <td rowspan="2" xpos="512" align="left" height="50" valign="top" width="32"><label>12</label></td>
            <td colspan="2" rowspan="2" xpos="544" align="left" height="50" valign="top" width="80"><input name="x12" size="10" tabindex="23" border="0" type="text"></td>
            <td colspan="2" rowspan="2" xpos="624" align="left" height="50" valign="top" width="84"><input name="y12" size="10" tabindex="24" border="0" type="text"></td>
            <td height="20" width="1"><spacer type="block" height="20" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="30">
            <td xpos="16" align="left" height="30" valign="top" width="64"><label><font color="red">r^2</font></label></td>
            <td xpos="80" align="left" height="30" valign="top" width="128"><input name="correlation" readonly="readonly" size="16" border="0" type="text"></td>
            <td xpos="288" align="left" height="30" valign="top" width="80"><label><font color="red"> Y mean</font> </label></td>
            <td xpos="368" align="left" height="30" valign="top" width="144"><input name="ymean" readonly="readonly" size="16" border="0" type="text"></td>
            <td height="30" width="1"><spacer type="block" height="30" width="1"></spacer><br>
            </td>
          </tr>
          <tr height="22">
            <td colspan="2" height="22" width="192"><br>
            </td>
            <td xpos="288" align="left" height="22" valign="top" width="80"><label><font color="green"> Y Lower</font> </label></td>
            <td xpos="368" align="left" height="22" valign="top" width="144"><input name="ylower" readonly="readonly" size="16" border="0" type="text"></td>
            <td colspan="5" height="22" width="196"><br>
            </td>
            <td height="22" width="1"><spacer type="block" height="22" width="1"></spacer><br>
            </td>
          </tr>
          <tr cntrlrow="" height="1">
            <td height="1" width="16"><spacer type="block" height="1" width="16"></spacer><br>
            </td>
            <td height="1" width="64"><spacer type="block" height="1" width="64"></spacer><br>
            </td>
            <td height="1" width="128"><spacer type="block" height="1" width="128"></spacer><br>
            </td>
            <td height="1" width="80"><spacer type="block" height="1" width="80"></spacer><br>
            </td>
            <td height="1" width="80"><spacer type="block" height="1" width="80"></spacer><br>
            </td>
            <td height="1" width="144"><spacer type="block" height="1" width="144"></spacer><br>
            </td>
            <td height="1" width="32"><spacer type="block" height="1" width="32"></spacer><br>
            </td>
            <td height="1" width="16"><spacer type="block" height="1" width="16"></spacer><br>
            </td>
            <td height="1" width="64"><spacer type="block" height="1" width="64"></spacer><br>
            </td>
            <td height="1" width="16"><spacer type="block" height="1" width="16"></spacer><br>
            </td>
            <td height="1" width="68"><spacer type="block" height="1" width="68"></spacer><br>
            </td>
            <td height="1" width="1"><br>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
    <script type="text/javascript">
	
	var screenx=500, offset=10, x;
  	
  	for (var i=0; i<screenx; i=i+5)	{
  	
  	x=i+offset+1;  
  		
	document.write("<div id=\'f"+i+"\' style=\'position:absolute; top:"+3+"px; left:"+x+"px; width:2px; height:2px; font-size=1; background-color:#ff0000\'></div>");
	
	document.write("<div id=\'da"+i+"\' style=\'position:absolute; top:"+1+"px; left:"+x+"px; width:2px; height:2px; font-size=1; background-color:#00ff00\'></div>");

	document.write("<div id=\'db"+i+"\' style=\'position:absolute; top:"+5+"px; left:"+x+"px; width:2px; height:2px; font-size=1; background-color:#00ff00\'></div>");

	}
	
	for (i=1; i<=12; i++)  {
	
	document.write("<div id=\'d"+i+"\' style=\'position:absolute; top:"+15+"px; left:"+(i*10)+"px; width:7px; height:1px; font-size=1; background-color:#0000ff\'></div>");
	
	document.write("<div id=\'e"+i+"\' style=\'position:absolute; top:"+20+"px; left:"+(i*10)+"px; width:1px; height:7px; font-size=1; background-color:#0000ff\'></div>");
	
	}
	
replot();


function replot() {

	var x = new Array(), y = new Array();
	var xfield, yfield, numpair;
	
for (var i=1; i<=12; i++) {
	
	xfield = "document.forms.f.x" + i + ".value";
	if (eval(xfield)==null || eval(xfield)=="") break;
	yfield = "document.forms.f.y" + i + ".value";
	
	x[i] = 1.0 * eval(xfield);
	y[i] = 1.0 * eval(yfield);
	
	}
	
	numpair=i-1;
		
var xmin = x[1], xmax = x[1];
var ymin = y[1], ymax = y[1];
var xs=0, ys=0, x2s=0, y2s=0, xys=0;

with (Math) {
for (i=1; i<=numpair; i++) {
	xmin = min(x[i],xmin);
	xmax = max(x[i],xmax);
	ymin = min(y[i],ymin);
	ymax = max(y[i],ymax);
	xs+=x[i];
	ys+=y[i];
	x2s+=x[i]*x[i];
	y2s+=y[i]*y[i];
	xys+=x[i]*y[i];

	}	
	
var slope, intercept, correlation;

	intercept = (ys*x2s - xys*xs)/(numpair*x2s - xs*xs);
	slope = (numpair*xys - xs*ys)/(numpair*x2s - xs*xs);
	correlation = (numpair*xys - xs*ys)/sqrt((numpair*x2s-xs*xs)*(numpair*y2s-ys*ys));
	correlation = correlation * correlation;

	var inter, slo, cor;
	
	inter=round(10000*intercept)/10000;
	slo=round(10000*slope)/10000;
	cor=round(10000*correlation)/10000;
	
	document.forms.f.intercept.value=inter.toString();
	document.forms.f.slope.value=slo.toString();
	document.forms.f.correlation.value=cor.toString();

var xd = xmax-xmin, yd = ymax-ymin;

xmin = xmin-0.1*xd; xmax = xmax+0.1*xd;
ymin = ymin-0.1*yd; ymax = ymax+0.1*yd;

var screenx=500, screeny=300, offset=10;
var xf=screenx/(xmax-xmin), yf=screeny/(ymax-ymin);
var x1, y1, x2, y2, y3, y4;

for (i=1; i<=numpair; i++) {

  	x1 = (x[i]-xmin)*xf + offset;
  	
  	y1 = y[i];
  	y1=screeny - (y1-ymin)*yf + offset;
  		
	ptr = "d"+i;
  	obj = document.getElementById(ptr);
  	obj.style.top = y1;
  	obj.style.left = x1-3;
  	obj.style.visibility = "visible";

	ptr = "e"+i;
  	obj = document.getElementById(ptr);
  	obj.style.top = y1-3;
  	obj.style.left = x1;
  	obj.style.visibility = "visible";

	}
	
for (i=numpair+1; i<=12; i++)	{

	ptr = "d"+i;
  	obj = document.getElementById(ptr);
  	obj.style.visibility = "hidden";

	ptr = "e"+i;
  	obj = document.getElementById(ptr);
  	obj.style.visibility = "hidden";
	
	}
	
	
for (var i=0; i<screenx; i=i+5)	{

  	x1 = i + offset;
   	x2 = i/xf + xmin;
  	
  	y2 = slope*x2 + intercept;
  	y1=screeny - (y2-ymin)*yf + offset;
  	
  	ptr = "f"+i;
  	obj = document.getElementById(ptr);
  	obj.style.top = y1;
  	(y2>ymax || y2<ymin) ? obj.style.visibility="hidden" : obj.style.visibility="visible";

		} 
		
var t95 = new Array(0, 6.314, 2.920, 2.353, 2.132, 2.015, 1.943, 1.895, 1.860, 1.833, 1.812);

var s2x, s2y, s2, s, xbar=xs/numpair

	s2x = (numpair*x2s - xs*xs)/numpair/(numpair-1);
	s2y = (numpair*y2s - ys*ys)/numpair/(numpair-1);
	s2 = (numpair-1)/(numpair-2)*(s2y - slope*slope*s2x);
	s2 = abs(s2);
	s = sqrt(s2);
	
for (var i=0; i<screenx; i=i+5)	{

  	x1 = i + offset;
   	x2 = i/xf + xmin;
  	
  	y3 = slope*x2 + intercept;
  	y2 = y3 - t95[numpair-2]*s*sqrt(1 + 1/numpair + (x2-xbar)*(x2-xbar)/(numpair-1)/s2x);
	
	y3 = y3+y3 - y2; 
  	
  	y1=screeny - (y2-ymin)*yf + offset;
  	y4=screeny - (y3-ymin)*yf + offset;
  	
  	ptr = "da"+i;
  	obj = document.getElementById(ptr);
  	obj.style.top = y1;
  	(y2>ymax || y2<ymin) ? obj.style.visibility="hidden" : obj.style.visibility="visible";
  	
  	ptr = "db"+i;
  	obj = document.getElementById(ptr);
  	obj.style.top = y4;
  	(y3>ymax || y3<ymin) ? obj.style.visibility="hidden" : obj.style.visibility="visible";

		} 
		
var xpred, ylower, ymean, yupper;

	xpred = 1.0 * document.forms.f.xpred.value;

  	ymean = slope*xpred + intercept;
  	ylower = ymean - t95[numpair-2]*s*sqrt(1 + 1/numpair + (xpred-xbar)*(xpred-xbar)/(numpair-1)/s2x);
	yupper = 2*ymean - ylower;
	
	ymean = round(ymean*100)/100;
	yupper = round(yupper*100)/100;
	ylower = round(ylower*100)/100;
	
	var yms = ymean.toString();
	var yus = yupper.toString();
	var yls = ylower.toString();
	
	document.forms.f.ymean.value=yms;
	document.forms.f.yupper.value=yus;
	document.forms.f.ylower.value=yls;
	
		}  } 

  </script>
    This page demonstrates the use of JavaScript and DHTML to generate a
    linear regression and graph of a data set. If you are specifically
    interested in analyzing drug stability data, use <a href="line2.html">this page</a>.
    Enter x and y values in the table on the right, and then press the
    Replot! button. If some error in the data causes a problem with
    JavaScript, correct the data and use the Refresh feature of your
    browser.
    <p>The dotted red line represents the best fit of the data to a
      straight line via a least-squares linear regression. The slope,
      intercept and r-squared (the square of the correlation
      coefficient) are
      given below the graph. The r-squared is an indication of how well
      correlated the x and y values are. A perfect correlation would
      give an
      r-squared of 1.</p>
    <p>The dotted green lines show a 90% double-sided confidence
      interval
      about the mean. You can be 90% confident that the true mean lies
      between the green lines. Viewed as single-sided confidence
      intervals,
      you can be 95% confident that either the true mean is below the
      upper
      green line, or that the true mean is above the lower green line.</p>
    <p>A prediction can be made about the value of y by entering a value
      for x into the box on the lower left and clicking on Replot! The
      predicted mean value for y, along with upper and lower confidence
      values for y are calculated based on a 90% double-sided or 95%
      single-sided confidence interval.</p>
    <p>If you need to print the graph, make sure your browser is set to
      print out webpage 'backgrounds'.</p>
    <hr>